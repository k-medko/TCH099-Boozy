CREATE TABLE Paiement (
    id_paiement     INT(10) PRIMARY KEY,
    nom             VARCHAR(10),
    prenom          VARCHAR(25),
    adresse_mail    VARCHAR(25),
    isAdmin         ENUM('oui', 'non'),
    isLivreur       ENUM('oui', 'non'),
    isMajeur        ENUM('oui', 'non'),
    numTel          VARCHAR(15),
    id_commande     INT(10),
    id_client       INT(10),
    CONSTRAINT fk_paiement_id_commande FOREIGN KEY (id_commande) REFERENCES Commande(id_commande),
    CONSTRAINT fk_paiement_id_client FOREIGN KEY (id_client) REFERENCES Utilisateur(id_client)
);

CREATE TABLE Utilisateur (
    email         VARCHAR(25) PRIMARY KEY,
    nom           VARCHAR(25),
    prenom        VARCHAR(25),
    num_tel       VARCHAR(15),
    type_utilisateur ENUM('client', 'livreur', 'admin'),
    id_client     INT(10),
    id_livreur    INT(10),
    id_admin      INT(10),
    plaque        VARCHAR(25),    
    disponibilite VARCHAR(10)  
);

CREATE TABLE Adresse (
    id_adresse  INT(10) PRIMARY KEY,
    rue         VARCHAR(25),
    code_postal VARCHAR(25),
    ville       VARCHAR(25),
    email       VARCHAR(25),
    CONSTRAINT fk_adresse_email FOREIGN KEY (email) REFERENCES Utilisateur(email)
);

CREATE TABLE Commande (
    id_commande     INT(10) PRIMARY KEY,
    date_creation   DATE,
    statut          VARCHAR(15),
    montant_total   DECIMAL(10,2),
    id_adresse      INT(10),
    id_magasin      INT(10),
    id_client       INT(10),
    CONSTRAINT fk_commande_id_adresse FOREIGN KEY (id_adresse) REFERENCES Adresse(id_adresse),
    CONSTRAINT fk_commande_id_magasin FOREIGN KEY (id_magasin) REFERENCES Magasin(id_magasin),
    CONSTRAINT fk_commande_id_client FOREIGN KEY (id_client) REFERENCES Utilisateur(id_client)
);

CREATE TABLE Commandes_Produits (
    id_commande     INT(10),
    id_produits     INT(10),
    quantite        INT(5),
    CONSTRAINT fk_Commandes_Produits_id_commande FOREIGN KEY (id_commande) REFERENCES Commande(id_commande),
    CONSTRAINT fk_Commandes_Produits_id_produits FOREIGN KEY (id_produits) REFERENCES Produits(id_produits)
);

CREATE TABLE Produits (
    id_produits     INT(25) PRIMARY KEY,
    nom             VARCHAR(25),
    description     VARCHAR(1000),
    prix            DECIMAL(10,2),
    categorie       VARCHAR(100),
    disponibilite   VARCHAR(20)
);

CREATE TABLE Produits_Magasin (
    id_magasin      INT(10),
    id_produits     INT(25),
    quantite        INT(5),
    CONSTRAINT pk_ProduitsMagasin_clefs_primaires PRIMARY KEY (id_magasin, id_produits),
    CONSTRAINT fk_ProduitsMagasin_id_magasin FOREIGN KEY (id_magasin) REFERENCES Magasin(id_magasin),
    CONSTRAINT fk_ProduitsMagasin_id_produits FOREIGN KEY (id_produits) REFERENCES Produits(id_produits)
);

CREATE TABLE Magasin (
    id_magasin   INT(10) PRIMARY KEY,
    nom          VARCHAR(25),
    id_adresse   INT(10),
    CONSTRAINT fk_Magasin_id_adresse FOREIGN KEY (id_adresse) REFERENCES Adresse(id_adresse)
);

CREATE TABLE Promotion (
    code        VARCHAR(25) PRIMARY KEY,
    description VARCHAR(500),
    reduction   DECIMAL(10,2),
    expiration  DATE,
    id_produits INT(10),
    CONSTRAINT fk_Promotion_id_produits FOREIGN KEY (id_produits) REFERENCES Produits(id_produits)
);
